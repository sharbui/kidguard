# 🌐 KidGuard Web UI 使用指南

## 概述

KidGuard Web UI 是一個友好的圖形化配置界面，讓家長無需手動編輯 YAML 文件，即可輕鬆設定所有保護規則。

---

## 🚀 啟動 Web UI

### 1. 安裝依賴

```bash
pip install -r requirements.txt
```

### 2. 啟動服務

```bash
python web_ui.py
```

### 3. 訪問界面

打開瀏覽器，訪問：
```
http://localhost:5555
```

---

## 📋 功能介紹

### 1. 🔧 基本設定

**Claude API 配置**
- 輸入您的 Claude API Key
- 選擇模型（Opus 4.6 / Sonnet 4.5 / Haiku 4.5）
- 測試 API 連接

**檢測規則**
- 設定保護年齡上限（預設 12 歲）
- 選擇違規處理方式：
  - 重導向到安全頻道
  - 跳過影片
  - 暫停播放
  - 僅通知家長
- 設定檢查間隔
- 調整信心閾值（越低越嚴格）

**安全頻道白名單**
- 添加 YouTube 頻道 ID 和名稱
- 違規時自動重導向到這些頻道

---

### 2. 👨‍👩‍👧‍👦 家庭成員

**添加家庭成員**
- 輸入姓名和年齡
- 標記是否為兒童（需要保護）
- 未來可關聯臉部識別數據

**管理成員**
- 查看所有家庭成員
- 刪除不需要的成員
- 修改成員信息

---

### 3. 🎯 自定義規則

#### 🌍 語言限制
- 啟用/停用語言限制
- 選擇允許的語言（中文、英文、日文等）
- 設定違規處理方式

#### 🤺 動作行為限制
- 添加禁止的動作類型
- 輸入動作描述和關鍵字
- 例如：砍擊揮砍、拳打腳踢、危險特技

#### 🔊 聲音表現限制
- 添加禁止的聲音類型
- 例如：尖叫、誇張大叫、粗俗言語

#### 🎨 視覺風格限制
- 勾選禁止的視覺風格
- 血腥畫面、陰暗恐怖、過度閃爍、性感暴露

#### 📺 主題內容限制
- 勾選禁止的主題
- 賭博遊戲、靈異、霸凌、惡作劇等

#### 🔤 關鍵字黑名單
- 輸入封鎖的關鍵字（每行一個）
- 標題或描述中包含這些詞將被封鎖

---

### 4. 📱 通知設定

**Telegram 通知**
- 啟用 Telegram 通知功能
- 輸入 Bot Token（從 @BotFather 獲取）
- 輸入 Chat ID（從 @userinfobot 獲取）

**通知選項**
- 是否在通知中包含截圖
- 是否只在阻擋內容時通知（避免過多通知）

---

### 5. 📋 快速模板

**嚴格模式** 👶
- 適合 4-7 歲幼兒
- 只允許中文
- 禁止所有暴力動作
- 極嚴格的過濾規則

**寬鬆模式** 🧒
- 適合 10-12 歲兒童
- 中英文都允許
- 只限制極端暴力
- 給予更多自由度

**預設配置** ⚙️
- 標準配置
- 適合大多數家庭
- 平衡的保護設定

**使用方式**
- 點擊模板卡片
- 確認載入
- 可在載入後自行調整

---

## 🛠️ 操作流程

### 首次設定

1. **選擇模板**（可選）
   - 切換到「快速模板」標籤
   - 選擇適合的模板作為起點

2. **配置 API**
   - 切換到「基本設定」
   - 輸入 Claude API Key
   - 點擊「測試連接」確認可用

3. **添加家庭成員**
   - 切換到「家庭成員」
   - 添加所有家庭成員
   - 標記哪些是兒童

4. **自定義規則**
   - 切換到「自定義規則」
   - 根據需求啟用/停用各項規則
   - 添加自己的過濾條件

5. **設定通知**
   - 切換到「通知設定」
   - 配置 Telegram（如果需要）

6. **保存配置**
   - 點擊底部「保存配置」按鈕
   - 配置會保存到 `config/config.yaml`

7. **驗證配置**
   - 點擊「驗證配置」檢查是否有錯誤
   - 修正任何警告或錯誤

8. **預覽 YAML**（可選）
   - 點擊「預覽 YAML」查看生成的配置文件
   - 可複製到剪貼板

---

## 💡 使用技巧

### 技巧 1：從模板開始
不要從零開始配置，選擇一個接近您需求的模板，然後微調。

### 技巧 2：逐步調整
第一次設定時可以稍微嚴格一些，根據實際使用情況再放寬。

### 技巧 3：測試 API
保存配置前，先測試 API 連接確保 Key 正確。

### 技巧 4：定期驗證
修改配置後，使用「驗證配置」功能檢查是否有問題。

### 技巧 5：備份配置
重要的配置可以使用「預覽 YAML」複製保存。

---

## 🔒 安全性

### 本地處理
- Web UI 運行在本地（localhost:5555）
- 只能從本機訪問
- 不會將配置上傳到任何外部服務器

### API Key 安全
- API Key 以密碼形式輸入（不顯示明文）
- 保存在本地配置文件中
- 建議設定檔案權限限制訪問

### 遠程訪問（進階）
如果需要從其他設備訪問：

```python
# 修改 web_ui.py
app.run(
    host='0.0.0.0',  # 允許外部訪問
    port=5000,
    debug=False      # 生產環境關閉 debug
)
```

⚠️ **注意：** 開放外部訪問前，請確保：
- 設定防火牆規則
- 使用 HTTPS（需額外配置）
- 添加身份驗證（需額外開發）

---

## 🐛 故障排除

### 問題 1：無法訪問 Web UI

**症狀：** 瀏覽器無法打開 http://localhost:5555

**解決方案：**
1. 確認 web_ui.py 正在運行
2. 檢查終端是否有錯誤訊息
3. 確認端口 5555 未被其他程式占用
4. 嘗試訪問 http://127.0.0.1:5555

### 問題 2：API 測試失敗

**症狀：** 點擊「測試連接」後顯示錯誤

**解決方案：**
1. 確認 API Key 格式正確（sk-ant-api03-...）
2. 檢查網路連接
3. 確認 API Key 有效且有額度
4. 查看終端錯誤訊息

### 問題 3：保存配置失敗

**症狀：** 點擊「保存配置」後顯示錯誤

**解決方案：**
1. 確認 `config/` 目錄存在
2. 檢查文件寫入權限
3. 使用「驗證配置」檢查配置是否有效
4. 查看終端錯誤訊息

### 問題 4：配置未生效

**症狀：** 保存了配置但 KidGuard 沒有使用新配置

**解決方案：**
1. 重啟 KidGuard 主程式（`python kidguard.py`）
2. 確認配置保存在 `config/config.yaml`（不是 example）
3. 檢查 KidGuard 日誌確認配置載入

---

## 📱 移動端適配

Web UI 已針對移動設備優化：
- 響應式設計
- 觸控友好的按鈕
- 適應小螢幕的布局

可以在手機或平板上訪問（需在同一局域網）：
```
http://[電腦IP]:5000
```

---

## 🎨 自定義外觀（進階）

如果您熟悉 CSS，可以修改 `web/static/css/style.css` 來自定義外觀：

```css
/* 例如：修改主題顏色 */
:root {
    --primary-color: #FF6B6B;  /* 改為紅色主題 */
    --secondary-color: #4ECDC4; /* 改為青色輔助色 */
}
```

---

## 🔮 未來功能

計劃中的功能：
- [ ] 即時預覽規則效果
- [ ] 歷史記錄查看
- [ ] 統計數據儀表板
- [ ] 多語言界面支援
- [ ] 暗黑模式
- [ ] 臉部識別設定
- [ ] 一鍵導出/導入配置

---

## 📞 技術支援

遇到問題？
1. 查看 `logs/kidguard.log` 日誌文件
2. 在 GitHub 提交 Issue
3. 參考 [README.md](../README.md) 和 [CUSTOM_RULES.md](./CUSTOM_RULES.md)

---

## 🙏 致謝

Web UI 基於以下技術構建：
- **Flask** - 輕量級 Python Web 框架
- **Vanilla JavaScript** - 無框架依賴，快速載入
- **Modern CSS** - 響應式設計，現代化界面

---

**💡 提示：** Web UI 讓配置變得簡單，但如果您熟悉 YAML，直接編輯配置文件也是可以的。兩種方式可以混用。
