# 🎥 KidGuard Live Monitor - 即時監控模式

## 概述

Live Monitor 是 KidGuard 的即時監控模式，讓 Claude 直接使用視覺分析能力來保護兒童，**無需 API Key**。

---

## 🚀 啟動方式

### 方法 1：雙擊啟動
```
start_live_monitor.bat
```

### 方法 2：命令行
```cmd
cd C:\projects\kidguard
python live_monitor.py
```

---

## 📋 安裝依賴

首次使用需要安裝額外套件：

```cmd
pip install mss psutil pyautogui pyperclip pillow
```

或安裝所有依賴：
```cmd
pip install -r requirements.txt
```

---

## 🔄 工作流程

```
1. 🟢 啟動監控
   ↓
2. 👀 偵測 YouTube 開啟
   ↓
3. 📸 自動擷取螢幕截圖
   ↓
4. 📤 將截圖路徑顯示給你
   ↓
5. 🤖 你將截圖給 Claude 分析
   ↓
6. 💬 Claude 告訴你該執行什麼動作
   ↓
7. ⌨️  你輸入 Claude 建議的指令
   ↓
8. 🎯 系統自動執行干預動作
   ↓
9. 🔁 繼續監控（每 10 秒檢查一次）
```

---

## 🎮 可用指令

當 Claude 分析完截圖後，你可以輸入以下指令：

| 指令 | 動作 | 說明 |
|------|------|------|
| `close` | 🚫 關閉分頁 | 立即關閉當前 YouTube 分頁 |
| `redirect` | ↪️ 重導向 | 導向到安全頻道（Cocomelon） |
| `pause` | ⏸️ 暫停影片 | 暫停當前影片播放 |
| `warn` | ⚠️ 顯示警告 | 彈出警告訊息 |
| `ok` | ✅ 繼續監控 | 內容安全，繼續監控 |
| `stop` | 🛑 停止 | 停止監控系統 |

---

## 💡 使用範例

### 場景 1：偵測到暴力內容

```
📸 擷取螢幕: yt_capture_20260210_163045_001.png

📋 截圖已保存: C:\projects\kidguard\screenshots\yt_capture_...

🤖 Claude 分析後，輸入指令執行動作：
👉 請輸入指令: close

🚫 執行干預：關閉 YouTube 分頁...
   ✓ 已發送關閉指令
```

### 場景 2：偵測到不適當但不嚴重

```
📸 擷取螢幕: yt_capture_20260210_163055_002.png

🤖 Claude 分析後，輸入指令執行動作：
👉 請輸入指令: redirect

↪️  執行干預：重導向到安全內容...
   ✓ 已重導向到安全頻道
```

### 場景 3：內容安全

```
📸 擷取螢幕: yt_capture_20260210_163105_003.png

🤖 Claude 分析後，輸入指令執行動作：
👉 請輸入指令: ok

✅ 內容安全，繼續監控...
```

---

## 🎯 Claude 分析指南

當截圖被擷取後，將圖片給 Claude 並詢問：

### 推薦提示詞

```
這是一張 YouTube 截圖，請分析內容是否適合 4-6 歲兒童觀看：

評估項目：
1. 是否有暴力、武器、打鬥場景？
2. 是否有恐怖、驚悚、血腥畫面？
3. 是否有不適當的語言或行為？
4. 是否符合家長設定的自定義規則？
5. 整體風格是否適合幼兒？

請給出建議的動作：
- close（嚴重不當）
- redirect（中度不當）
- warn（輕度不當）
- ok（內容安全）
```

### Claude 回應範例

**不當內容：**
```
⚠️ 不適合！

發現問題：
- 影片中有持刀械的動作場景
- 畫面風格陰暗恐怖
- 違反「動作限制」規則（砍擊揮砍）

建議動作：close
嚴重程度：高
```

**安全內容：**
```
✅ 內容安全

檢查結果：
- 教育性動畫內容
- 色彩明亮、音樂輕快
- 符合幼兒觀看標準

建議動作：ok
```

---

## ⚙️ 配置選項

你可以在 `live_monitor.py` 中調整參數：

```python
self.check_interval = 10  # 檢查間隔（秒）
```

改為：
```python
self.check_interval = 30  # 每 30 秒檢查一次（較寬鬆）
self.check_interval = 5   # 每 5 秒檢查一次（更嚴格）
```

---

## 🔒 安全性與隱私

### ✅ 優點
- **完全本地運行** - 不需要 API Key
- **截圖存在本地** - 不上傳到雲端
- **即時反應** - Claude 直接分析，無延遲
- **人工控制** - 最終決策由你控制

### ⚠️ 注意事項
- 截圖會保存在 `screenshots/` 目錄
- 可定期清理舊截圖以節省空間
- 需要手動將截圖給 Claude 分析（未來可自動化）

---

## 🐛 故障排除

### 問題 1：無法偵測到 YouTube

**原因：** 瀏覽器進程名稱不在清單中

**解決：** 修改 `live_monitor.py` 第 25 行，添加你的瀏覽器：
```python
browsers = ['chrome.exe', 'firefox.exe', 'msedge.exe', 'brave.exe', '你的瀏覽器.exe']
```

### 問題 2：截圖失敗

**原因：** 缺少 mss 套件

**解決：**
```cmd
pip install mss pillow
```

### 問題 3：干預動作無效

**原因：** pyautogui 權限問題

**解決：**
1. 以管理員身份運行
2. 或手動執行干預動作

### 問題 4：快捷鍵衝突

**原因：** 某些應用攔截了快捷鍵

**解決：** 修改 `live_monitor.py` 中的快捷鍵組合

---

## 🚀 進階用法

### 自動化 Claude 分析（未來功能）

可以整合 Claude API，實現完全自動化：

```python
# 在 capture_screen 後自動調用 Claude API
result = self.analyze_with_claude(screenshot_path)
if result['action'] != 'ok':
    self.execute_action(result['action'])
```

### 多螢幕支援

```python
# 擷取特定螢幕
monitor = sct.monitors[2]  # 第二個螢幕
```

### 自定義安全頻道

```python
# 修改 redirect_to_safe 方法
safe_url = "https://www.youtube.com/c/你的安全頻道"
```

---

## 📊 使用統計

監控結束後會顯示：
```
🛑 監控已停止
📊 總共擷取: 15 張截圖
```

所有截圖保存在 `screenshots/` 目錄，可用於：
- 事後審查
- 訓練數據
- 改進規則

---

## 💡 最佳實踐

### 1️⃣ 首次使用
- 先觀察幾次，熟悉流程
- 測試各種干預動作的效果
- 根據實際情況調整檢查間隔

### 2️⃣ 日常使用
- 在孩子使用設備前啟動監控
- 準備好 Claude 對話視窗
- 快速將截圖給 Claude 分析
- 根據 Claude 建議執行動作

### 3️⃣ 規則調整
- 記錄 Claude 的分析結果
- 識別常見的不當內容模式
- 更新自定義規則（語言、動作、主題等）

---

## 🎓 Claude 分析訓練

為了提高分析準確度，可以：

### 建立分析模板

```
我是 KidGuard 的內容審查員，請幫我分析這張 YouTube 截圖。

我的自定義規則：
- 只允許中文內容
- 禁止砍擊揮砍動作
- 禁止尖叫和誇張大叫
- 禁止血腥、恐怖畫面
- 禁止賭博、靈異主題

請檢查並給出：
1. 違規項目（如有）
2. 嚴重程度（高/中/低）
3. 建議動作（close/redirect/warn/ok）
```

### 記錄決策

建立分析日誌：
```
時間: 2026-02-10 16:30
截圖: yt_capture_20260210_163045_001.png
分析: 發現武器動作場景
決策: close
結果: 成功關閉分頁
```

---

## 🔮 未來功能

計劃中的增強功能：

- [ ] 整合 Claude API 實現全自動分析
- [ ] 機器學習輔助（識別常見模式）
- [ ] 家長遠程監控（手機 App）
- [ ] 智能學習（根據歷史調整判斷）
- [ ] 多用戶配置（不同孩子不同規則）

---

**現在就啟動 Live Monitor，讓我用視覺分析來保護你的孩子！** 🛡️👀
